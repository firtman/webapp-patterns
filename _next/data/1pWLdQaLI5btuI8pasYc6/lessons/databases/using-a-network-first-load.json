{"pageProps":{"post":{"attributes":{},"html":"<h1 id=\"network-first-menu\">Network First Menu</h1>\n<p>At <code>Menu.js</code> change the <code>load</code> method with the following one and analyze the database created and the algorithm.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-attr\">load</span>: <span class=\"hljs-keyword\">async</span> () =&gt; {\n    <span class=\"hljs-comment\">// Network First</span>\n    <span class=\"hljs-keyword\">const</span> db = <span class=\"hljs-keyword\">await</span> <span class=\"hljs-title class_\">Menu</span>.<span class=\"hljs-title function_\">openDB</span>();\n    <span class=\"hljs-keyword\">try</span> {\n        <span class=\"hljs-comment\">// We try to fetch from the network</span>\n        <span class=\"hljs-keyword\">const</span> data = <span class=\"hljs-keyword\">await</span> <span class=\"hljs-variable constant_\">API</span>.<span class=\"hljs-title function_\">fetchMenu</span>();\n        <span class=\"hljs-title class_\">Menu</span>.<span class=\"hljs-property\">data</span> = data;\n        <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;Data from the network&quot;</span>);\n        <span class=\"hljs-comment\">// If succeded, also update the cached version</span>\n        db.<span class=\"hljs-title function_\">clear</span>(<span class=\"hljs-string\">&#x27;categories&#x27;</span>);            \n        data.<span class=\"hljs-title function_\">forEach</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">category</span> =&gt;</span> db.<span class=\"hljs-title function_\">add</span>(<span class=\"hljs-string\">&#x27;categories&#x27;</span>, category));\n    } <span class=\"hljs-keyword\">catch</span> (e) {\n        <span class=\"hljs-comment\">// Network error, we go to the cache</span>\n        <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-keyword\">await</span> db.<span class=\"hljs-title function_\">count</span>(<span class=\"hljs-string\">&#x27;categories&#x27;</span>) &gt; <span class=\"hljs-number\">0</span>) {\n            <span class=\"hljs-title class_\">Menu</span>.<span class=\"hljs-property\">data</span> = <span class=\"hljs-keyword\">await</span> db.<span class=\"hljs-title function_\">getAll</span>(<span class=\"hljs-string\">&#x27;categories&#x27;</span>);\n            <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;Data from the cache&quot;</span>);\n        } <span class=\"hljs-keyword\">else</span> {\n            <span class=\"hljs-comment\">// No cached data is available :(</span>\n            <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&quot;No data is available&quot;</span>);\n        }\n    }\n    <span class=\"hljs-title class_\">Menu</span>.<span class=\"hljs-title function_\">render</span>();\n}\n</code></pre>\n","slug":"using-a-network-first-load","title":"Using a Network First Load","section":"Databases","icon":"database","filePath":"/Users/firt/Library/Mobile Documents/com~apple~CloudDocs/Trainings/FEM/DataStorage/browser-storage/lessons/03-databases/E-using-a-network-first-load.md","nextSlug":"/browser-storage/lessons/cache-storage/caching-images","prevSlug":"/browser-storage/lessons/databases/making-a-cache-first-load"}},"__N_SSG":true}