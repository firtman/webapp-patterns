{"pageProps":{"post":{"attributes":{},"html":"<h1 id=\"replacing-web-storage\">Replacing Web Storage</h1>\n<p>We will now replace our Web Storage implementation with new versions of <code>load</code> and <code>save</code> in our <code>Order.js</code> file. Also, we are creating a new <code>loadDB</code> method, as in the following code:</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-attr\">openDB</span>: <span class=\"hljs-keyword\">async</span> () =&gt; {\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">await</span> idb.<span class=\"hljs-title function_\">openDB</span>(<span class=\"hljs-string\">&quot;cm-storage&quot;</span>, <span class=\"hljs-number\">1</span>, {\n        <span class=\"hljs-keyword\">async</span> <span class=\"hljs-title function_\">upgrade</span>(<span class=\"hljs-params\">db</span>) {\n            <span class=\"hljs-keyword\">await</span> db.<span class=\"hljs-title function_\">createObjectStore</span>(<span class=\"hljs-string\">&quot;order&quot;</span>);\n        }\n    })\n}\n</code></pre>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-attr\">load</span>: <span class=\"hljs-keyword\">async</span> () =&gt; {\n    <span class=\"hljs-keyword\">const</span> db = <span class=\"hljs-keyword\">await</span> <span class=\"hljs-title class_\">Order</span>.<span class=\"hljs-title function_\">openDB</span>();\n    <span class=\"hljs-keyword\">const</span> cartString = <span class=\"hljs-keyword\">await</span> db.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&quot;order&quot;</span>, <span class=\"hljs-string\">&quot;cart&quot;</span>);\n    <span class=\"hljs-keyword\">if</span> (cartString) {\n        <span class=\"hljs-keyword\">try</span> {\n            <span class=\"hljs-title class_\">Order</span>.<span class=\"hljs-property\">cart</span> = <span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">parse</span>(cartString);  \n        } <span class=\"hljs-keyword\">catch</span> (e) {\n            <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">error</span>(<span class=\"hljs-string\">&quot;Data in Storage is corrupted&quot;</span>);\n        }\n    }\n    <span class=\"hljs-title class_\">Order</span>.<span class=\"hljs-title function_\">render</span>();\n}\n</code></pre>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-attr\">save</span>: <span class=\"hljs-keyword\">async</span> () =&gt; {\n    <span class=\"hljs-keyword\">const</span> db = <span class=\"hljs-keyword\">await</span> <span class=\"hljs-title class_\">Order</span>.<span class=\"hljs-title function_\">openDB</span>();\n    <span class=\"hljs-keyword\">await</span> db.<span class=\"hljs-title function_\">put</span>(<span class=\"hljs-string\">&quot;order&quot;</span>, <span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">stringify</span>(<span class=\"hljs-title class_\">Order</span>.<span class=\"hljs-property\">cart</span>), <span class=\"hljs-string\">&quot;cart&quot;</span>)\n}\n</code></pre>\n","slug":"replacing-web-storage","title":"Replacing Web Storage","section":"Databases","icon":"database","filePath":"/Users/firt/Library/Mobile Documents/com~apple~CloudDocs/Trainings/FEM/DataStorage/browser-storage/lessons/03-databases/B-replacing-web-storage.md","nextSlug":"/browser-storage/lessons/databases/creating-a-database-for-the-menu","prevSlug":"/browser-storage/lessons/databases/setting-up-indexeddb"}},"__N_SSG":true}